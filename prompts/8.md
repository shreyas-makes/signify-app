# Step 8: Enhanced Document Model

You are enhancing the Document model to support publishing workflow and keystroke metadata.

CONTEXT: This is step 8 of 16. Basic document CRUD and editor with auto-save exist. Now prepare documents for the publishing system.

REQUIREMENTS:
1. Add publishing-related fields:
   - Published_at timestamp for publication date
   - Public_slug for SEO-friendly URLs (different from internal slug)
   - Word_count for quick statistics
   - Reading_time_minutes for reader information
   - Keystroke_count for verification stats

2. Implement status workflow:
   - Enhance status enum: draft → ready_to_publish → published
   - Add published? and draft? convenience methods
   - Prevent editing of published documents
   - Add workflow validation rules

3. Create slug generation system:
   - Auto-generate public_slug from title for published posts
   - Ensure public_slug uniqueness across all published documents
   - Handle slug conflicts with incremental numbering
   - Preserve original slug for drafts

4. Add content analysis methods:
   - Calculate word count from content
   - Estimate reading time (200 words per minute)
   - Count total keystrokes from associated records
   - Generate content statistics for display

IMPLEMENTATION APPROACH:
- Use Rails callbacks for automatic field updates
- Add model validations for workflow enforcement
- Implement efficient slug generation
- Use database indexes for performance

TESTING REQUIREMENTS:
- Tests for status workflow and validations
- Slug generation and uniqueness tests
- Content analysis method tests
- Performance tests for large documents

DELIVERABLES:
- Enhanced Document model with publishing fields
- Robust slug generation system
- Content analysis methods
- Comprehensive test coverage

Prepare the Document model to support the publishing workflow while maintaining data integrity.